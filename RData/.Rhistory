runme(sink = ear,source = Cervix)
runme(sink = "ear",source = "Cervix")
runme<-function(sink,source){
tmp<-df2%>%filter(Sink==sink)%>%filter(Source==source)
model <- lm(contribution ~  disease, data = tmp)
analysis <- Anova(model, idata = tmp, idesign = ~patient)
print(analysis)
}
runme(sink = "ear",source = "Cervix")
runme<-function(sink,source){
tmp<-df2%>%filter(Sink==sink)%>%filter(Source==source)
model <- lm(contribution ~  disease, data = tmp)
#analysis <- Anova(model, idata = tmp, idesign = ~patient)
#print(analysis)
}
runme(sink = "ear",source = "Cervix")
tmp<-df2%>%
filter(Sink%in%sink)%>%
filter(Source%in%source)
runme<-function(sink,source){
tmp<-df2%>%
filter(Sink%in%sink)%>%
filter(Source%in%source)
model <- lm(contribution ~  disease, data = tmp)
#analysis <- Anova(model, idata = tmp, idesign = ~patient)
#print(analysis)
}
runme(sink = "ear",source = "Cervix")
lapply(X = unique(df2$Sink),
FUN =function(si){
lapply(X = unique(df2$Source),
FUN =  function(so){
tmp=df2%>%
filter(Sink%in%si)%>%
filter(Source%in%so)
model <- lm(contribution ~  disease, data = tmp)
}}))
lapply(X = unique(df2$Sink),
FUN =function(si){
lapply(X = unique(df2$Source),
FUN =  function(so){
tmp=df2%>%
filter(Sink%in%si)%>%
filter(Source%in%so)
model <- lm(contribution ~  disease, data = tmp)
})})
lapply(X = unique(df2$Sink),
FUN =function(si){
lapply(X = unique(df2$Source),
FUN =  function(so){
tmp=df2%>%
filter(Sink%in%si)%>%
filter(Source%in%so)
model <- lm(contribution ~  disease, data = tmp)
analysis <- Anova(model, idata = tmp, idesign = ~patient)
})})
library(broom)
lapply(X = unique(df2$Sink),
FUN =function(si){
lapply(X = unique(df2$Source),
FUN =  function(so){
tmp=df2%>%
filter(Sink%in%si)%>%
filter(Source%in%so)
model <- lm(contribution ~  disease, data = tmp)
analysis <- tidy(Anova(model, idata = tmp, idesign = ~patient))
})})
lapply(X = unique(df2$Sink),
FUN =function(si){
lapply(X = unique(df2$Source),
FUN =  function(so){
tmp=df2%>%
filter(Sink%in%si)%>%
filter(Source%in%so)
model <- lm(contribution ~  disease, data = tmp)
analysis <- tidy(Anova(model, idata = tmp, idesign = ~patient))%>%
mutate9(Sink=si,Source=so)
})})
lapply(X = unique(df2$Sink),
FUN =function(si){
lapply(X = unique(df2$Source),
FUN =  function(so){
tmp=df2%>%
filter(Sink%in%si)%>%
filter(Source%in%so)
model <- lm(contribution ~  disease, data = tmp)
analysis <- tidy(Anova(model, idata = tmp, idesign = ~patient))%>%
mutate(Sink=si,Source=so)
})})
df2$Delivery
lapply(X = unique(df2$Source),
FUN =  function(so){
lapply(X = unique(df2$Delivery),
FUN =  function(de){
tmp=df2%>%
filter(Sink%in%si)%>%
filter(Source%in%so)%>%
filter(Delivery%in%de)
model <- lm(contribution ~  disease, data = tmp)
analysis <- tidy(Anova(model, idata = tmp, idesign = ~patient))%>%
mutate(Sink=si,Source=so)
})})
lapply(X = unique(df2$Sink),
FUN =function(si){
lapply(X = unique(df2$Source),
FUN =  function(so){
lapply(X = unique(df2$Delivery),
FUN =  function(de){
tmp=df2%>%
filter(Sink%in%si)%>%
filter(Source%in%so)%>%
filter(Delivery%in%de)
model <- lm(contribution ~  disease, data = tmp)
analysis <- tidy(Anova(model, idata = tmp, idesign = ~patient))%>%
mutate(Sink=si,Source=so)
})})})
lapply(X = unique(df2$Sink),
FUN =function(si){
lapply(X = unique(df2$Source),
FUN =  function(so){
lapply(X = unique(df2$Delivery),
FUN =  function(de){
tmp=df2%>%
filter(Sink%in%si)%>%
filter(Source%in%so)%>%
filter(Delivery%in%de)
model <- lm(contribution ~  disease, data = tmp)
analysis <- tidy(Anova(model, idata = tmp, idesign = ~patient))%>%
mutate(Sink=si,Source=so,Delivery=de)
})})})
lapply(X = unique(df2$Sink),
FUN =function(si){
lapply(X = unique(df2$Source),
FUN =  function(so){
lapply(X = unique(df2$Delivery),
FUN =  function(de){
tmp=df2%>%
filter(Sink%in%si)%>%
filter(Source%in%so)%>%
filter(Delivery%in%de)
model <- lm(contribution ~  disease, data = tmp)
analysis <- tidy(Anova(model, idata = tmp, idesign = ~patient))%>%
mutate(Sink=si,Source=so,Delivery=de)
})})})
df2
lapply(X = unique(df2$Sink),
FUN =function(si){
lapply(X = unique(df2$Source),
FUN =  function(so){
tmp=df2%>%
filter(Sink%in%si)%>%
filter(Source%in%so)
model <- lm(contribution ~  disease, data = tmp)
analysis <- tidy(Anova(model, idata = tmp, idesign = ~patient))%>%
mutate(Sink=si,Source=so)
})})
model <- lm(contribution ~  disease*Delivery, data = tmp)
lapply(X = unique(df2$Sink),
FUN =function(si){
lapply(X = unique(df2$Source),
FUN =  function(so){
tmp=df2%>%
filter(Sink%in%si)%>%
filter(Source%in%so)
model <- lm(contribution ~  disease*Delivery, data = tmp)
analysis <- tidy(Anova(model, idata = tmp, idesign = ~patient))%>%
mutate(Sink=si,Source=so)
})})
lapply(X = unique(df2$Sink),
FUN =function(si){
lapply(X = unique(df2$Source),
FUN =  function(so){
tmp=df2%>%
filter(Sink%in%si)%>%
filter(Source%in%so)
model <- lm(contribution ~  disease*Delivery, data = tmp)
analysis <- tidy(aov(model, idata = tmp, idesign = ~patient))%>%
mutate(Sink=si,Source=so)
})})
lapply(X = unique(df2$Sink),
FUN =function(si){
lapply(X = unique(df2$Source),
FUN =  function(so){
tmp=df2%>%
filter(Sink%in%si)%>%
filter(Source%in%so)
model <- lm(contribution ~  disease*Delivery+patient, data = tmp)
analysis <- tidy(Anova(model, idata = tmp, idesign = ~patient))%>%
mutate(Sink=si,Source=so)
})})
lapply(X = unique(df2$Sink),
FUN =function(si){
lapply(X = unique(df2$Source),
FUN =  function(so){
tmp=df2%>%
filter(Sink%in%si)%>%
filter(Source%in%so)
model <- lm(contribution ~  disease*Delivery+patient, data = tmp)
analysis <- tidy(aov(model))%>%#, idata = tmp, idesign = ~patient))%>%
mutate(Sink=si,Source=so)
})})
lapply(X = unique(df2$Sink),
FUN =function(si){
lapply(X = unique(df2$Source),
FUN =  function(so){
tmp=df2%>%
filter(Sink%in%si)%>%
filter(Source%in%so)
model <- lm(contribution ~  disease*Delivery+patient, data = tmp)
analysis <- tidy(anova(model))%>%#, idata = tmp, idesign = ~patient))%>%
mutate(Sink=si,Source=so)
})})
lapply(X = unique(df2$Sink),
FUN =function(si){
lapply(X = unique(df2$Source),
FUN =  function(so){
tmp=df2%>%
filter(Sink%in%si)%>%
filter(Source%in%so)
model <- lm(contribution ~  disease*Delivery+patient, data = tmp)
analysis <- summary(aov(model))%>%#, idata = tmp, idesign = ~patient))%>%
mutate(Sink=si,Source=so)
})})
analysis <- tidy(summary(aov(model)))%>%#, idata = tmp, idesign = ~patient))%>%
mutate(Sink=si,Source=so)
lapply(X = unique(df2$Sink),
FUN =function(si){
lapply(X = unique(df2$Source),
FUN =  function(so){
tmp=df2%>%
filter(Sink%in%si)%>%
filter(Source%in%so)
model <- lm(contribution ~  disease*Delivery+patient, data = tmp)
analysis <- tidy(aov(model))%>%#, idata = tmp, idesign = ~patient))%>%
mutate(Sink=si,Source=so)
})})
lapply(X = unique(df2$Sink),
FUN =function(si){
lapply(X = unique(df2$Source),
FUN =  function(so){
tmp=df2%>%
filter(Sink%in%si)%>%
filter(Source%in%so)
model <- lm(contribution ~  disease*Delivery+patient, data = tmp)
analysis <- Anova(aov(model))%>%#, idata = tmp, idesign = ~patient))%>%
mutate(Sink=si,Source=so)
})})
lapply(X = unique(df2$Sink),
FUN =function(si){
lapply(X = unique(df2$Source),
FUN =  function(so){
tmp=df2%>%
filter(Sink%in%si)%>%
filter(Source%in%so)
model <- lm(contribution ~  disease*Delivery+patient, data = tmp)
analysis <- Anova(aov(model))#%>%#, idata = tmp, idesign = ~patient))%>%
#mutate(Sink=si,Source=so)
})})
analysis <- Anova(model)#%>%#, idata = tmp, idesign = ~patient))%>%
lapply(X = unique(df2$Sink),
FUN =function(si){
lapply(X = unique(df2$Source),
FUN =  function(so){
tmp=df2%>%
filter(Sink%in%si)%>%
filter(Source%in%so)
model <- lm(contribution ~  disease*Delivery+patient, data = tmp)
analysis <- Anova(model)#%>%#, idata = tmp, idesign = ~patient))%>%
#mutate(Sink=si,Source=so)
})})
lapply(X = unique(df2$Sink),
FUN =function(si){
lapply(X = unique(df2$Source),
FUN =  function(so){
tmp=df2%>%
filter(Sink%in%si)%>%
filter(Source%in%so)
model <- lm(contribution ~  disease*Delivery+patient, data = tmp)
analysis <- Anova(model)#%>%#, idata = tmp, idesign = ~patient))%>%
#mutate(Sink=si,Source=so)
})})
analysis <- aov(model)#%>%#, idata = tmp, idesign = ~patient))%>%
lapply(X = unique(df2$Sink),
FUN =function(si){
lapply(X = unique(df2$Source),
FUN =  function(so){
tmp=df2%>%
filter(Sink%in%si)%>%
filter(Source%in%so)
model <- lm(contribution ~  disease*Delivery+patient, data = tmp)
analysis <- aov(model)#%>%#, idata = tmp, idesign = ~patient))%>%
#mutate(Sink=si,Source=so)
})})
lapply(X = unique(df2$Sink),
FUN =function(si){
lapply(X = unique(df2$Source),
FUN =  function(so){
tmp=df2%>%
filter(Sink%in%si)%>%
filter(Source%in%so)
model <- lm(contribution ~  disease*Delivery+patient, data = tmp)
analysis <- summary(aov(model))#%>%#, idata = tmp, idesign = ~patient))%>%
#mutate(Sink=si,Source=so)
})})
lapply(X = unique(df2$Sink),
FUN =function(si){
lapply(X = unique(df2$Source),
FUN =  function(so){
tmp=df2%>%
filter(Sink%in%si)%>%
filter(Source%in%so)
model <- lm(contribution ~  disease*Delivery+patient, data = tmp)
analysis <- summary(anova(model))#%>%#, idata = tmp, idesign = ~patient))%>%
#mutate(Sink=si,Source=so)
})})
lapply(X = unique(df2$Sink),
FUN =function(si){
lapply(X = unique(df2$Source),
FUN =  function(so){
tmp=df2%>%
filter(Sink%in%si)%>%
filter(Source%in%so)
model <- lm(contribution ~  disease*Delivery+patient, data = tmp)
analysis <- tidy(Anova(model, idata = tmp, idesign = ~patient))%>%
mutate(Sink=si,Source=so)
})})
lapply(X = unique(df2$Sink),
FUN =function(si){
lapply(X = unique(df2$Source),
FUN =  function(so){
tmp=df2%>%
filter(Sink%in%si)%>%
filter(Source%in%so)
model <- lm(contribution ~  disease*Delivery, data = tmp)
analysis <- tidy(aov(model, idata = tmp, idesign = ~patient))%>%
mutate(Sink=si,Source=so)
})})
df2
lapply(X = unique(df2$Sink),
FUN =function(si){
lapply(X = unique(df2$Source),
FUN =  function(so){
tmp=df2%>%
filter(Sink%in%si)%>%
filter(Source%in%so)
model <- lm(contribution ~  disease*Delivery, data = tmp)
analysis <- tidy(aov(model))#, idata = tmp, idesign = ~patient))%>%
mutate(Sink=si,Source=so)
})})
lapply(X = unique(df2$Sink),
FUN =function(si){
lapply(X = unique(df2$Source),
FUN =  function(so){
tmp=df2%>%
filter(Sink%in%si)%>%
filter(Source%in%so)
model <- lm(contribution ~  disease*Delivery, data = tmp)
analysis <- tidy(aov(model))%>%#, idata = tmp, idesign = ~patient))%>%
mutate(Sink=si,Source=so)
})})
df2
ear_Cervix
ear_Cervix_Csection<-ear_Cervix%>%filter(Delivery==("Csection"))
ear_Cervix_Csection
hist(x = ear_Cervix_Csection$contribution)
library(ggpubr)
gghistogram(data = ear_Cervix_Csection,x=contribution)
gghistogram(data = ear_Cervix_Csection,x="contribution")
gghistogram(data = ear_Cervix_Csection,x="contribution")
gghistogram(data = ear_Cervix_Csection,x="contribution",color = "disease")
gghistogram(data = ear_Cervix_Csection,x="contribution",color = "disease",bins = 25)
ear_Cervix_Csection_disease<-ear_Cervix_Csection%>%
wilcox.test(contribution~disease,data = ear_Cervix_Csection)
ear_Cervix_Csection_disease<-ear_Cervix_Csection%>%
wilcox.test(disease~contribution,data = ear_Cervix_Csection)
hsb2 <- within(read.csv("https://stats.idre.ucla.edu/stat/data/hsb2.csv"), {
race <- as.factor(race)
schtyp <- as.factor(schtyp)
prog <- as.factor(prog)
})
attach(hsb2)
write
female
hsb2
model <- lm(contribution ~  disease, data = ear_Cervix)
model <- lm(contribution ~  disease, data = df2)
analysis <- Anova(model, idata = df2, idesign = ~patient)
print(analysis)
model <- msummary(aov(lm(contribution ~  disease, data = df2)))
model
model <- aov(lm(contribution ~  disease, data = df2))
model
model <- Anova(lm(contribution ~  disease, data = df2))
model
model <- Anova(lm(contribution ~  Delivery, data = df2))
model
model <- Anova(contribution ~  Delivery, data = df2))
model <- Anova(contribution ~  Delivery, data = df2)
model
model <- aov(contribution ~  Delivery, data = df2)
model
model <- msummary(aov(contribution ~  Delivery, data = df2))
model
model <- summary(aov(contribution ~  Delivery, data = df2))
model
analysis <- Anova(model, idata = df2, idesign = ~patient)
df2
model <- summary(aov(contribution ~  Source, data = df2))
model
model <- summary(aov(contribution ~  Source*Sink, data = df2))
model
df3
model <- summary(aov(contribution ~  env, data = df2))
model
model <- summary(aov(contribution ~  env, data = df2))
model <- summary(aov(lm(contribution ~  env, data = df2)))
model
df3
df4
model <- summary(aov(lm(contribution ~  id, data = df4)))
model
TukeyHSD(model)
df4
df2
df_slim<-df2%>%select(SampleID,patient,contribution)
df_slim
df_slim<-df2%>%select(SampleID,patient,disease,Delivery,Antibiotics,contribution)
df_slim
t.test(write, read, paired = TRUE)
read
write
df_slim
model <- lm(contibution ~ disease + patient, data = df_slim)
model <- lm(contribution ~ disease + patient, data = df_slim)
analysis <- Anova(model, idata = df_slim, idesign = ~patient)
model <- lm(contribution ~ disease + patient, data = df_slim)
analysis <- Anova(model, idata = df_slim, idesign = ~patient)
print(analysis)
df_slim
model <- lm(contribution ~ disease *Delivery+ patient, data = df_slim)
analysis <- Anova(model, idata = df_slim, idesign = ~patient)
print(analysis)
model <- lm(contribution ~ ., data = df_slim)
analysis <- Anova(model, idata = df_slim, idesign = ~patient)
print(analysis)
library(lme4)
glmer(contibution ~ disease + (1 | patient), data = df_slim, family = gaussian)
glmer(contribution ~ disease + (1 | patient), data = df_slim, family = gaussian)
ses
glmeree<-glmer(contribution ~ disease + (1 | patient), data = df_slim, family = gaussian)
summary(glmeree)
msummary(glmeree)
msummary(aov(glmeree))
aov(glmeree))
aov(glmeree)
aanova(glmeree)
anova(glmeree)
Anova(glmeree)
Anova(contribution ~ disease + (1 | patient), data = df_slim)
aov(contribution ~ disease + (1 | patient), data = df_slim)
glmeree<-glmer(contribution ~ disease *Delivery + (1 | patient), data = df_slim, family = gaussian)
glmeree<-glmer(contribution ~ disease *Delivery + (1 | patient), data = df_slim)
glmeree
summary(glmeree)
#logistic regression
logit_mod <- glm(contribution ~ disease,
data = df_slim)
msummary(logit_mod)
#logistic regression
logit_mod <- glm(contribution ~ disease*Delivery,
data = df_slim)
msummary(logit_mod)
tidy(logit_mod, conf.int = TRUE,
exponentiate = TRUE)
df2
#logistic regression
logit_mod <- glm(contribution ~ disease*Delivery,
data = df2)
msummary(logit_mod)
#logistic regression
logit_mod <- glm(contribution ~ disease*Delivery+ (1 | patient),
data = df2)
#logistic regression
logit_mod <- glm(contribution ~ disease+ (1 | patient),
data = df2)
glmeree<-glmer(contribution ~ disease *Delivery + (1 | patient), data = df_slim)
summary(glmeree)
tidy(glmeree, conf.int = TRUE,
exponentiate = TRUE)
glmeree<-glmer(contribution ~ disease  + (1 | patient), data = df_slim)
summary(glmeree)
glmeree<-glmer(contribution ~ disease  + (1 | patient), data = df_slim,family = "binomial")
summary(glmeree)
glmeree<-glmer(contribution ~ disease  + (1 | patient), data = df_slim)
summary(glmeree)
glmeree<-glmer(contribution ~ disease  + (1 | patient), data = df_slim,family = "gaussian")
summary(glmeree)
glmeree<-glmer(contribution ~ disease  + (1 | patient), data = df_slim,family = "quasibinomial")
summary(glmeree)
glmeree<-glmer(contribution ~ disease  + (1 | patient), data = df_slim,family = "quasi")
summary(glmeree)
glmeree<-glmer(contribution ~ disease  + (1 | patient), data = df_slim,family = "poisson")
summary(glmeree)
glmeree<-glmer(contribution ~ disease  + (1 | patient), data = df_slim,family = "binomial")
summary(glmeree)
glmeree<-glmer(contribution ~ disease *delivery + (1 | patient), data = df_slim,family = "binomial")
glmeree<-glmer(contribution ~ disease *Delivery + (1 | patient), data = df_slim,family = "binomial")
summary(glmeree)
df_slim
glmeree<-glmer(contribution ~ . + (1 | patient), data = df_slim,family = "binomial")
glmeree<-glmer(contribution ~ disease *Delivery* Antibiotics + (1 | patient), data = df_slim,family = "binomial")
summary(glmeree)
