sam%>%filter(disease=="T!D")
sam%>%filter(disease=="T1D")
vec
sam%>%filter(disease=="T1D")
vec
tmp3.5<-vec%>%ungroup()%>%select(patient,disease,HbA1C_1trym_2,Delivery, controlled,newborn_weight)%>%distinct_all()
vec
sam%>%filter(disease=="T1D")
vec<-as_tibble(data.frame(sample_data(ASV_physeq_core)))%>%group_by(patient,disease)%>%
filter(disease=="T1D")%>%
select(patient,disease,HbA1C_1trym_2,Delivery,newborn_weight,controlled)%>%distinct_all()
vec<-as_tibble(data.frame(sample_data(ASV_physeq_core)))%>%group_by(patient,disease)%>%
filter(disease=="T1D")%>%
select(patient,disease,HbA1C_1trym_2,Delivery,newborn_weight,controlled)%>%distinct_all()
vec<-as_tibble(data.frame(sample_data(ASV_physeq_core)))%>%group_by(patient,disease)%>%
filter(disease=="T1D")%>%
select(patient,disease,HbA1C_1trym_2,Delivery,controlled)%>%distinct_all()
vec%>%filter(controlled=="FALSE")
sam<-sam%>%select(patient,disease,HbA1C_1trym_2,Delivery,controlled)%>%distinct_all()
sam
vec
sam%>%filter(patient==10)
vec%>%filter(patient==10)
tally(disease~controlled+Delivery,vec)
tally(disease~controlled+Delivery,sam)
tmp2<-as_tibble(data.frame(sample_data(t)))%>%select(patient,disease,tydzien_porodu_2,newborn_weight,starts_with("HbA1C_"))%>%distinct_all()%>%select(-c(HbA1C_1trym_2))
tmp2
vec
tmp3<-full_join(vec,tmp2)
tmp3
tmp3.5<-vec%>%ungroup()%>%select(patient,disease,HbA1C_1trym_2,Delivery,controlled,newborn_weight)%>%distinct_all()
tmp3.5<-tmp3%>%ungroup()%>%select(patient,disease,HbA1C_1trym_2,Delivery,controlled,newborn_weight)%>%distinct_all()
tmp3.5
tmp3.5<-tmp3%>%filter(disease=="T1D")%>%ungroup()%>%select(patient,disease,HbA1C_1trym_2,Delivery,controlled,newborn_weight)%>%distinct_all()
tmp3.5
p<-ggplot(tmp3.5,mapping = aes(x = newborn_weight,y =HbA1C_1trym_2,
group=patient,
color=controlled)) +
geom_line() +
geom_point(mapping=aes(shape=Delivery))+
scale_color_manual(values = my_pal)+
scale_fill_manual(values = my_pal)+
theme_pubr(legend = "right")+facet_grid(~Delivery)+
ggtitle(label = "Outlier T1D patients with vaginal delivery 1st trimester HbA1c values > 7.2")
ggpar(p = p,yticks.by = 0.2)
p<-ggplot(tmp3.5,mapping = aes(y = newborn_weight,x =HbA1C_1trym_2,
group=patient,
color=controlled)) +
geom_line() +
geom_point(mapping=aes(shape=Delivery))+
scale_color_manual(values = my_pal)+
scale_fill_manual(values = my_pal)+
theme_pubr(legend = "right")+facet_grid(~Delivery)+
ggtitle(label = "Outlier T1D patients with vaginal delivery 1st trimester HbA1c values > 7.2")
ggpar(p = p,yticks.by = 0.2)
ggpar(p = p,xticks.by = 0.2)
p<-ggplot(tmp3.5,mapping = aes(y = newborn_weight,x =HbA1C_1trym_2,
group=patient,
color=controlled)) +
geom_line() +
geom_point(mapping=aes(shape=Delivery))+
scale_color_manual(values = my_pal)+
scale_fill_manual(values = my_pal)+
theme_pubr(legend = "right")+
ggtitle(label = "Outlier T1D patients with vaginal delivery 1st trimester HbA1c values > 7.2")
ggpar(p = p,xticks.by = 0.2)
p<-ggplot(tmp3.5,mapping = aes(y = newborn_weight,x =HbA1C_1trym_2,
group=patient,
color=controlled)) +
geom_line() +
geom_point(mapping=aes(shape=Delivery))+
scale_color_manual(values = my_pal)+
scale_fill_manual(values = my_pal)+
theme_pubr(legend = "right")+
ggtitle(label = "T1D 1st trimester HbA1c x newborn weight",subtitle = "color= 1st trimester HbA1c values > 7.2, shape= Delivery mode")
ggpar(p = p,xticks.by = 0.2)
p<-ggplot(tmp3.5,mapping = aes(y = newborn_weight,x =HbA1C_1trym_2,
group=patient,
color=controlled)) +
geom_line() +
geom_point(mapping=aes(shape=Delivery))+
scale_color_manual(values = my_pal)+
scale_fill_manual(values = my_pal)+
theme_pubr(legend = "right")+
ggtitle(label = "T1D 1st trimester HbA1c x newborn weight",subtitle = "color= 1st trimester HbA1c values > 7.2,
shape= Delivery mode")
ggpar(p = p,xticks.by = 0.2)
p<-ggplot(tmp3.5,mapping = aes(y = newborn_weight,x =HbA1C_1trym_2,
group=patient,
color=controlled)) +
geom_line() +
geom_point(mapping=aes(shape=Delivery))+
scale_color_manual(values = my_pal)+
scale_fill_manual(values = my_pal)+
theme_pubr(legend = "right")+
ggtitle(label = "T1D 1st trimester HbA1c x newborn weight",
subtitle = "
color= 1st trimester HbA1c values > 7.2,
shape= Delivery mode")
ggpar(p = p,xticks.by = 0.2)
p<-ggplot(tmp3.5,mapping = aes(y = newborn_weight,x =HbA1C_1trym_2,
group=patient,
color=controlled)) +
geom_line() +
geom_point(mapping=aes(shape=Delivery))+
scale_color_manual(values = my_pal)+
scale_fill_manual(values = my_pal)+
theme_pubr(legend = "right")+
ggtitle(label = "T1D 1st trimester HbA1c x newborn weight",
subtitle = "
color = 1st trimester HbA1c values > 7.2
shape = Delivery mode")
ggpar(p = p,xticks.by = 0.2)
ggpar(p = p,xticks.by = 0.2,xlab = "1st trimester HbA1c",ylab = "newborn weight")
p<-ggplot(tmp3.5,mapping = aes(y = newborn_weight,x =HbA1C_1trym_2,
group=patient,
color=controlled)) +
geom_line() +
geom_point(mapping=aes(shape=Delivery))+
scale_color_manual(values = my_pal)+
scale_fill_manual(values = my_pal)+
ggpar(p = p,
legend = "right"
xticks.by = 0.2,
xlab = "1st trimester HbA1c",
ylab = "newborn weight",
title = "T1D 1st trimester HbA1c x newborn weight",
subtitle = "
color = 1st trimester HbA1c values > 7.2
shape = Delivery mode"))
p<-ggplot(tmp3.5,mapping = aes(y = newborn_weight,x =HbA1C_1trym_2,
group=patient,
color=controlled)) +
geom_line() +
geom_point(mapping=aes(shape=Delivery))+
scale_color_manual(values = my_pal)+
scale_fill_manual(values = my_pal)+
ggpar(p = p,
legend = "right"
xticks.by = 0.2,
xlab = "1st trimester HbA1c",
ylab = "newborn weight",
title = "T1D 1st trimester HbA1c x newborn weight",
subtitle = "
color = 1st trimester HbA1c values > 7.2
shape = Delivery mode")
p<-ggplot(tmp3.5,mapping = aes(y = newborn_weight,x =HbA1C_1trym_2,
group=patient,
color=controlled)) +
geom_line() +
geom_point(mapping=aes(shape=Delivery))+
scale_color_manual(values = my_pal)+
scale_fill_manual(values = my_pal)+
ggpar(p = p,
legend = "right"
xticks.by = 0.2,
xlab = "1st trimester HbA1c",
ylab = "newborn weight",
title = "T1D 1st trimester HbA1c x newborn weight",
subtitle = "
color = 1st trimester HbA1c values > 7.2
shape = Delivery mode")
p<-ggplot(tmp3.5,mapping = aes(y = newborn_weight,x =HbA1C_1trym_2,
group=patient,
color=controlled)) +
geom_line() +
geom_point(mapping=aes(shape=Delivery))+
scale_color_manual(values = my_pal)+
scale_fill_manual(values = my_pal)
ggpar(p = p,
legend = "right"
xticks.by = 0.2,
xlab = "1st trimester HbA1c",
ylab = "newborn weight",
title = "T1D 1st trimester HbA1c x newborn weight",
subtitle = "
color = 1st trimester HbA1c values > 7.2
shape = Delivery mode")
ggpar(p = p,
legend = "right"
xticks.by = 0.2,
xlab = "1st trimester HbA1c",
ylab = "newborn weight",
title = "T1D 1st trimester HbA1c x newborn weight",
subtitle = "color = 1st trimester HbA1c values > 7.2
shape = Delivery mode")
p<-ggplot(tmp3.5,mapping = aes(y = newborn_weight,x =HbA1C_1trym_2,
group=patient,
color=controlled)) +
geom_line() +
geom_point(mapping=aes(shape=Delivery))+
scale_color_manual(values = my_pal)+
scale_fill_manual(values = my_pal)
p
ggpar(p = p,
legend = "right",
xticks.by = 0.2,
xlab = "1st trimester HbA1c",
ylab = "newborn weight",
title = "T1D 1st trimester HbA1c x newborn weight",
subtitle = "
color = 1st trimester HbA1c values > 7.2
shape = Delivery mode")
ggpar(p = p,
legend = "right",ggtheme = theme_bw(),
xticks.by = 0.2,
xlab = "1st trimester HbA1c",
ylab = "newborn weight",
title = "T1D 1st trimester HbA1c x newborn weight",
subtitle = "
color = 1st trimester HbA1c values > 7.2
shape = Delivery mode")
ggpar(p = p,
legend = "right",
ggtheme = theme_minimal(),
xticks.by = 0.2,
xlab = "1st trimester HbA1c",
ylab = "newborn weight",
title = "T1D 1st trimester HbA1c x newborn weight",
subtitle = "
color = 1st trimester HbA1c values > 7.2
shape = Delivery mode")
ggpar(p = p,
legend = "right",
ggtheme = theme_minimal(),
xticks.by = 0.2,
xlab = "1st trimester HbA1c",
ylab = "newborn weight",
title = "T1D 1st trimester HbA1c x newborn weight",
subtitle = "
color = 1st trimester HbA1c values > 7.2
shape = Delivery mode")
ggpar(p = p,
legend = "right",
ggtheme = theme_classic(),
xticks.by = 0.2,
xlab = "1st trimester HbA1c",
ylab = "newborn weight",
title = "T1D 1st trimester HbA1c x newborn weight",
subtitle = "
color = 1st trimester HbA1c values > 7.2
shape = Delivery mode")
ggpar(p = p,
legend = "right",
ggtheme = theme_classic2(),
xticks.by = 0.2,
xlab = "1st trimester HbA1c",
ylab = "newborn weight",
title = "T1D 1st trimester HbA1c x newborn weight",
subtitle = "
color = 1st trimester HbA1c values > 7.2
shape = Delivery mode")
ggpar(p = p,
legend = "right",
ggtheme = theme_pubclean(),
xticks.by = 0.2,
xlab = "1st trimester HbA1c",
ylab = "newborn weight",
title = "T1D 1st trimester HbA1c x newborn weight",
subtitle = "
color = 1st trimester HbA1c values > 7.2
shape = Delivery mode")
ggpar(p = p,
legend = "right",
ggtheme = theme_minimal(),
xticks.by = 0.2,
xlab = "1st trimester HbA1c",
ylab = "newborn weight",
title = "T1D 1st trimester HbA1c x newborn weight",
subtitle = "
color = 1st trimester HbA1c values > 7.2
shape = Delivery mode")
p<-ggplot(tmp3.5,mapping = aes(y = newborn_weight,x =HbA1C_1trym_2,
group=patient,label=patient,
color=controlled)) +
geom_line() +
geom_point(mapping=aes(shape=Delivery))+
scale_color_manual(values = my_pal)+
scale_fill_manual(values = my_pal)
p
p<-ggplot(tmp3.5,mapping = aes(y = newborn_weight,x =HbA1C_1trym_2,
group=patient,
color=controlled)) +
geom_line() +
geom_point(mapping=aes(shape=Delivery,label=patient))+
scale_color_manual(values = my_pal)+
scale_fill_manual(values = my_pal)
p
p<-ggplot(tmp3.5,mapping = aes(y = newborn_weight,x =HbA1C_1trym_2,
group=patient,
color=controlled)) +
geom_line() +
geom_point(mapping=aes(shape=Delivery,))+
geom_label(mapping = aes(label=patient))
scale_color_manual(values = my_pal)+
scale_fill_manual(values = my_pal)
p
p<-ggplot(tmp3.5,mapping = aes(y = newborn_weight,x =HbA1C_1trym_2,
group=patient,
color=controlled)) +
geom_line() +
geom_point(mapping=aes(shape=Delivery,))+
geom_label(mapping = aes(label=patient))+
scale_color_manual(values = my_pal)+
scale_fill_manual(values = my_pal)
p
ggpar(p = p,
legend = "right",
ggtheme = theme_minimal(),
xticks.by = 0.2,
xlab = "1st trimester HbA1c",
ylab = "newborn weight",
title = "T1D 1st trimester HbA1c x newborn weight",
subtitle = "
color = 1st trimester HbA1c values > 7.2
shape = Delivery mode")
tmp3
tmp4
p<-ggplot(tmp3.5,mapping = aes(y = newborn_weight,x =HbA1C_1trym_2,
group=patient,
color=controlled)) +
geom_line() +
geom_point(mapping=aes(shape=Delivery,))+
geom_label(mapping = aes(label=newborn_weight))+
scale_color_manual(values = my_pal)+
scale_fill_manual(values = my_pal)
p
ggpar(p = p,
legend = "right",
ggtheme = theme_minimal(),
xticks.by = 0.2,
xlab = "1st trimester HbA1c",
ylab = "newborn weight",
title = "T1D 1st trimester HbA1c x newborn weight",
subtitle = "
color = 1st trimester HbA1c values > 7.2
shape = Delivery mode")
tmp3.5
11+22+2+14
tab<-tally(~disease+Delivery+controlled,data=tmp3.5,"data.frame")%>%filter(Freq>0)
ggbarplot(data = tab,
x = "disease",
y = "Freq",
fill="controlled",
label = tab$Freq,
palette = my_pal,
position = position_dodge(),
ylab = "Patients (n)",xlab = "Diabetes",
facet.by = "Delivery",title = "Diabetes by delivery mode colored by 1st Trimester HbA1c >7.2",
ggtheme = theme_pubr(legend = "right"))
tab<-tally(~disease+Delivery+controlled,data=tmp3,"data.frame")%>%filter(Freq>0)
ggbarplot(data = tab,
x = "disease",
y = "Freq",
fill="controlled",
label = tab$Freq,
palette = my_pal,
position = position_dodge(),
ylab = "Patients (n)",xlab = "Diabetes",
facet.by = "Delivery",title = "Diabetes by delivery mode colored by 1st Trimester HbA1c >7.2",
ggtheme = theme_pubr(legend = "right"))
tab<-tally(~disease+Delivery+controlled,data=tmp,"data.frame")%>%filter(Freq>0)
ggbarplot(data = tab,
x = "disease",
y = "Freq",
fill="controlled",
label = tab$Freq,
palette = my_pal,
position = position_dodge(),
ylab = "Patients (n)",xlab = "Diabetes",
facet.by = "Delivery",title = "Diabetes by delivery mode colored by 1st Trimester HbA1c >7.2",
ggtheme = theme_pubr(legend = "right"))
tab<-tally(~disease+Delivery+controlled,data=sam,"data.frame")%>%filter(Freq>0)
ggbarplot(data = tab,
x = "disease",
y = "Freq",
fill="controlled",
label = tab$Freq,
palette = my_pal,
position = position_dodge(),
ylab = "Patients (n)",xlab = "Diabetes",
facet.by = "Delivery",title = "Diabetes by delivery mode colored by 1st Trimester HbA1c >7.2",
ggtheme = theme_pubr(legend = "right"))
sam<-data.frame(sample_data(ASV_physeq_core))%>%mutate(controlled=as_factor(HbA1C_1trym_2=7.2))
#investifgete 10 and 8.7 vaginal
# 2nd and 3rd trimester a1c and newborn weights
t<-readRDS("ASV_physeq_core.rds")
sam<-data.frame(sample_data(ASV_physeq_core))%>%mutate(controlled=as_factor(HbA1C_1trym_2=7.2))
ASV_physeq_core
sam<-data.frame(sample_data(ASV_physeq_core))%>%mutate(controlled=as_factor(HbA1C_1trym_2>7.2))
sam%>%filter(patient==10)
tally(disease~controlled,sam)
sample_data(ASV_physeq_core)<-sample_data(sam)
tmp<-subset_samples(ASV_physeq_core,Host=="Mother")
sam<-as_tibble(data.frame(sample_data(ASV_physeq_core)))%>%
filter(Host=="Mother")%>%
select(patient,disease,Delivery,controlled)%>%distinct_all()
t1dsam<-as_tibble(data.frame(sample_data(ASV_physeq_core)))%>%
filter(Host=="Mother")%>%
select(patient,disease,Delivery,controlled,HbA1C_1trym_2)%>%
filter(disease=="T1D")%>%
distinct_all()
t1dsam$patient<-as_factor(t1dsam$patient)
t1dsam
p<-ggscatter(data = t1dsam,title = "Type 1 Diabetic 1st Trimester HbA1c values x delivery mode colored by controlled <7.2",
x = "HbA1C_1trym_2",
y="Delivery",
color = "controlled",
palette = my_pal,label = t1dsam$HbA1C_1trym_2,repel = T,
shape = "Delivery")+rotate_x_text()
ggpar(p = p,xticks.by = 0.2)
tally(~disease,data=t1dsam,"data.frame")%>%filter(Freq>0)
library(mosaic)
tab<-tally(~disease+Delivery+controlled,data=sam,"data.frame")%>%filter(Freq>0)
ggbarplot(data = tab,
x = "disease",
y = "Freq",
fill="controlled",
label = tab$Freq,
palette = my_pal,
position = position_dodge(),
ylab = "Patients (n)",xlab = "Diabetes",
facet.by = "Delivery",title = "Diabetes by delivery mode colored by 1st Trimester HbA1c >7.2",
ggtheme = theme_pubr(legend = "right"))
#tmp<-subset_samples(ASV_physeq_core,Host=="Infant")
sam<-data.frame(sample_data(ASV_physeq))%>%mutate(controlled=as_factor(HbA1C_1trym_2<7.2))
library(parallel)
library(doParallel)
library(microbiome)
library(tidyverse)
library(ggpubr)
library(cowplot)
library(ggsci)
library(scales)
#tmp<-subset_samples(ASV_physeq_core,Host=="Infant")
sam<-data.frame(sample_data(ASV_physeq))%>%mutate(controlled=as_factor(HbA1C_1trym_2<7.2))
sample_data(tmp)<-sample_data(sam)
sam$controlled
ASV_physeq_core
sam<-data.frame(sample_data(ASV_physeq_core))%>%mutate(controlled=as_factor(HbA1C_1trym_2>7.2))
sam%>%filter(patient==10)
tally(disease~controlled,sam)
library(mosaic)
#investifgete 10 and 8.7 vaginal
# 2nd and 3rd trimester a1c and newborn weights
t<-readRDS("ASV_physeq_core.rds")
ASV_physeq_core
sam<-data.frame(sample_data(ASV_physeq_core))%>%mutate(controlled=as_factor(HbA1C_1trym_2>7.2))
sam%>%filter(patient==10)
tally(disease~controlled,sam)
sam%>%group_by(patient,disease)%>%select(patient,disease,HbA1C_1trym_2Delivery,controlled))
sam%>%group_by(patient,disease)%>%select(patient,disease,HbA1C_1trym_2Delivery,controlled)%>%distinct_all()
sam%>%group_by(patient,disease)%>%select(patient,disease,HbA1C_1trym_2,Delivery,controlled)%>%distinct_all()
sam<-sam%>%filter(disease=="T1D")%>%group_by(patient,disease)%>%select(patient,disease,HbA1C_1trym_2,Delivery,controlled)%>%distinct_all()
sam
tally(disease~controlled,sam)
tally(~controlled,sam)
tally(Delivery~controlled,sam)
t1dsam<-sam%>%filter(disease=="T1D")%>%group_by(patient,disease)%>%select(patient,disease,HbA1C_1trym_2,Delivery,controlled)%>%distinct_all()
sam
tally(Delivery~controlled,sam)
p<-ggscatter(data = t1dsam,title = "Type 1 Diabetic 1st Trimester HbA1c values x delivery mode colored by controlled <7.2",
x = "HbA1C_1trym_2",
y="Delivery",
color = "controlled",
palette = my_pal,label = t1dsam$HbA1C_1trym_2,repel = T,
shape = "Delivery")+rotate_x_text()
ggpar(p = p,xticks.by = 0.2)
tally(~disease,data=t1dsam,"data.frame")%>%filter(Freq>0)
library(mosaic)
tab<-tally(~disease+Delivery+controlled,data=sam,"data.frame")%>%filter(Freq>0)
ggbarplot(data = tab,
x = "disease",
y = "Freq",
fill="controlled",
label = tab$Freq,
palette = my_pal,
position = position_dodge(),
ylab = "Patients (n)",xlab = "Diabetes",
facet.by = "Delivery",title = "Diabetes by delivery mode colored by 1st Trimester HbA1c >7.2",
ggtheme = theme_pubr(legend = "right"))
sam
sam<-data.frame(sample_data(ASV_physeq_core))%>%mutate(controlled=as_factor(HbA1C_1trym_2=>7.2))
t1dsam<-sam%>%filter(disease=="T1D")%>%group_by(patient,disease)%>%select(patient,disease,HbA1C_1trym_2,Delivery,controlled)%>%distinct_all()
sam
sam<-data.frame(sample_data(ASV_physeq_core))%>%mutate(controlled=as_factor(HbA1C_1trym_2=>7.2))
ASV_physeq_core
sam<-data.frame(sample_data(ASV_physeq_core))%>%mutate(controlled=as_factor(HbA1C_1trym_2=>7.2))
sam<-data.frame(sample_data(ASV_physeq_core))%>%mutate(controlled=as_factor(HbA1C_1trym_2>=7.2))
t1dsam<-sam%>%filter(disease=="T1D")%>%group_by(patient,disease)%>%select(patient,disease,HbA1C_1trym_2,Delivery,controlled)%>%distinct_all()
sam
tally(Delivery~controlled,sam)
p<-ggscatter(data = t1dsam,title = "Type 1 Diabetic 1st Trimester HbA1c values x delivery mode colored by controlled <7.2",
x = "HbA1C_1trym_2",
y="Delivery",
color = "controlled",
palette = my_pal,label = t1dsam$HbA1C_1trym_2,repel = T,
shape = "Delivery")+rotate_x_text()
ggpar(p = p,xticks.by = 0.2)
tally(~disease,data=t1dsam,"data.frame")%>%filter(Freq>0)
library(mosaic)
tab<-tally(~disease+Delivery+controlled,data=sam,"data.frame")%>%filter(Freq>0)
ggbarplot(data = tab,
x = "disease",
y = "Freq",
fill="controlled",
label = tab$Freq,
palette = my_pal,
position = position_dodge(),
ylab = "Patients (n)",xlab = "Diabetes",
facet.by = "Delivery",title = "Diabetes by delivery mode colored by 1st Trimester HbA1c >7.2",
ggtheme = theme_pubr(legend = "right"))
