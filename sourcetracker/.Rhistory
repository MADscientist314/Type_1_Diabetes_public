df<-as_tibble(read.table("k:/github/Type_1_Diabetes_public/sourcetracker/sourcetracker_results.txt",header = T,sep = "\t"))
library(tidyverse)
df<-as_tibble(read.table("k:/github/Type_1_Diabetes_public/sourcetracker/sourcetracker_results.txt",header = T,sep = "\t"))
df
df<-as_tibble(read.table("k:/github/Type_1_Diabetes_public/sourcetracker/sourcetracker_results.txt",header = F,sep = "\t"))
df
df<-as_tibble(read.table("k:/github/Type_1_Diabetes_public/sourcetracker/sourcetracker_results.txt",header = T,sep = "\t"))
df
df2<-df%>%select(ends_with(2))
df2
df2<-df%>%select(ends_with("2"))
df2
df2<-df%>%select(starts_with("2"))
df2
df2<-df[,17:21]
df2
df2<-df[,-17:21]
df2<-df[,-c(17:21)]
df2<-df[,17:21]
df2
df2<-df[,-c(17:21)]
df2
df2<-df2%>%select(Study,SampleType,Delivery,Antibiotics,Anus,Cervix,Introitus,Vagina,Unknown)
df2
df2<-df2%>%
select(Study,SampleType,Delivery,Antibiotics,Anus,Cervix,Introitus,Vagina,Unknown)%>%
group_by(Study,SampleType)%>%
summarize(across(c(5:9),.fns = mean,.names = {.col}))
df2<-df2%>%
select(Study,SampleType,Delivery,Antibiotics,Anus,Cervix,Introitus,Vagina,Unknown)
df2
df2<-df2%>%group_by(Study,SampleType)%>%
summarize(across(c(5:9),.fns = mean,.names = {.col}))
df2<-df2%>%group_by(Study,SampleType)%>%
summarize(across(c(5:7),.fns = mean,.names = {.col}))
df<-as_tibble(read.table("k:/github/Type_1_Diabetes_public/sourcetracker/sourcetracker_results.txt",header = T,sep = "\t"))
df
df2<-df[,-c(17:21)]
df<-as_tibble(read.table("k:/github/Type_1_Diabetes_public/sourcetracker/sourcetracker_results.txt",header = T,sep = "\t"))
df
df2<-df2%>%
select(Study,SampleType,Delivery,Antibiotics,Anus,Cervix,Introitus,Vagina,Unknown)
df2
df2<-df[,17:21]
df2
df
df2<-df2%>%
select(Study,SampleType,Delivery,Antibiotics,Anus,Cervix,Introitus,Vagina,Unknown,
X2_Anus,X2_Cervix,X2_Introitus,X2_Vagina,X2_Unknown)
df2
df2<-df2%>%
select(Study,SampleType,Delivery,Antibiotics,Anus,Cervix,Introitus,Vagina,Unknown,X2_Anus,X2_Cervix,X2_Introitus,X2_Vagina,X2_Unknown)
df2<-df%>%
select(Study,SampleType,Delivery,Antibiotics,Anus,Cervix,Introitus,Vagina,Unknown,X2_Anus,X2_Cervix,X2_Introitus,X2_Vagina,X2_Unknown)
df2<-df%>%
select(Study,SampleType,Delivery,Antibiotics,Anus,Cervix,Introitus,Vagina,Unknown,
X2_Anus,X2_Cervix,X2_Introitus,X2_Vagina,X2_Unknown)
df2
df2
df2<-df2%>%pivot_longer(cols = c(Anus,Cervix,Introitus,Vagina,Unknown,
df2<-df%>%
select(Study,SampleType,Delivery,Antibiotics,Anus,Cervix,Introitus,Vagina,Unknown)#,
df2
df2
df2<-df2%>%pivot_longer(cols =c(Anus,Cervix,Introitus,Vagina,Unknown),names_to = "Source",values_to = "contribution")
df2
df2<-df%>%
select(Study,SampleType,Delivery,Antibiotics,Anus,Cervix,Introitus,Vagina,Unknown)#,
df2
df2
df2<-df2%>%pivot_longer(cols =c(Anus,Cervix,Introitus,Vagina,Unknown),names_to = "Source",values_to = "contribution")
df2
df2<-df2%>%pivot_longer(cols =c(Anus,Cervix,Introitus,Vagina,Unknown),names_to = "Source",values_to = "contribution")
df2<-df2%>%group_by(Study,SampleType,Delivery,Source)%>%summarize(contribution=mean(contribution))
df2
df2<-df2%>%group_by(Study,SampleType,Delivery,Source)%>%summarize(contribution=mean(contribution))%>%ungroup()
df2
df2<-df2%>%pivot_longer(cols =c(Anus,Cervix,Introitus,Vagina,Unknown),names_to = "Source",values_to = "contribution")
df2<-df2%>%group_by(Study,SampleType,Delivery,Source)%>%summarize(contribution=mean(contribution))%>%ungroup()
df2
df2<-df%>%
select(Study,SampleType,Delivery,Antibiotics,Anus,Cervix,Introitus,Vagina,Unknown)#,
df2
df2
df2<-df2%>%pivot_longer(cols =c(Anus,Cervix,Introitus,Vagina,Unknown),names_to = "Source",values_to = "contribution")
df2<-df2%>%group_by(Study,SampleType,Delivery,Source)%>%summarize(contribution=mean(contribution))%>%ungroup()
df2
df2<-df%>%
select(Study,SampleType,Delivery,Antibiotics,Anus,Cervix,Introitus,Vagina,Unknown)#,
df2
df2
df2<-df2%>%pivot_longer(cols =c(Anus,Cervix,Introitus,Vagina,Unknown),names_to = "Source",values_to = "contribution")
df2
library(ggpubr)
ggboxplot(data = df2,x = "Source",y = "contribution",color = "Study")
ggboxplot(data = df2,x = "Source",y = "contribution",color = "Study")+stat_compare_means(comparisons = list(c("Control","T1D")))
my_comparisons <- list(c("Control","T1D"))
ggboxplot(data = df2,x = "Source",y = "contribution",color = "Study")+stat_compare_means(comparisons = my_comparisons)
ggboxplot(data = df2,x = "Study",y = "contribution",color = "Source")+stat_compare_means(comparisons = my_comparisons)
ggboxplot(data = df2,x = "Study",y = "contribution",facet.by =  "Source")+stat_compare_means(comparisons = my_comparisons)
ggboxplot(data = df2,x = "Study",y = "contribution",facet.by =  "Source")+
stat_compare_means(comparisons = my_comparisons)
ggboxplot(data = df2,x = "Study",y = "contribution",facet.by =  "Source",color="Source")+
stat_compare_means(comparisons = my_comparisons)
ggboxplot(data = df2,x = "Study",y = "contribution",facet.by =  "Source",color="Source",add="jitter")+
stat_compare_means(comparisons = my_comparisons)
ggboxplot(data = df2,x = "Study",y = "contribution",facet.by =  c("Source","SampleType"),color="Source",add="jitter")+
stat_compare_means(comparisons = my_comparisons)
ggboxplot(data = df2,x = "Study",y = "contribution",facet.by =  c("SampleType","Source"),color="Source",add="jitter")+
stat_compare_means(comparisons = my_comparisons)
df2<-df%>%
select(Study,SampleType,Delivery,Antibiotics,
#Anus,Cervix,Introitus,Vagina,Unknown)#,
X2_Anus,X2_Cervix,X2_Introitus,X2_Vagina,X2_Unknown)
df2
df2<-df2%>%pivot_longer(cols =-c(Study,SampleType,Delivery,Antibiotics),names_to = "Source",values_to = "contribution")
df2
library(ggpubr)
my_comparisons <- list(c("Control","T1D"))
ggboxplot(data = df2,x = "Study",y = "contribution",facet.by =  c("SampleType","Source"),color="Source",add="jitter")+
stat_compare_means(comparisons = my_comparisons)
df2<-df%>%
select(Study,SampleType,Delivery,Antibiotics,
Anus,Cervix,Introitus,Vagina,Unknown)#,
df2
df2
df2<-df2%>%pivot_longer(cols =-c(Study,SampleType,Delivery,Antibiotics),names_to = "Source",values_to = "contribution")
df2
library(ggpubr)
my_comparisons <- list(c("Control","T1D"))
ggboxplot(data = df2,x = "Study",y = "contribution",facet.by =  c("SampleType","Source"),color="Source",add="jitter")+
stat_compare_means(comparisons = my_comparisons)
ggboxplot(data = df2,x = "Study",y = "contribution",color="Source",add="jitter")+
facet_grid(Source~SampleType)
ggboxplot(data = df2,x = "Study",y = "contribution",color="Source",add="jitter")+
facet_grid(Delivery+Source~SampleType)
ggboxplot(data = df2,x = "Study",y = "contribution",color="Source",add="jitter")+
facet_grid(Delivery+Source~SampleType)+
stat_compare_means(comparisons = my_comparisons)
ggboxplot(data = df2,x = "Study",y = "contribution",color="Source",add="jitter")+
facet_grid(Source~SampleType+Delivery)+
stat_compare_means(comparisons = my_comparisons)
ggboxplot(data = df2,x = "Study",y = "contribution",color="Source",add="jitter")+
facet_grid(Source~SampleType+Delivery)+
stat_compare_means(comparisons = my_comparisons,method = "Wilcox")
ggboxplot(data = df2,x = "Study",y = "contribution",color="Source",add="jitter")+
facet_grid(Source~SampleType+Delivery)+
stat_compare_means(comparisons = my_comparisons,method = "wilcox")
ggboxplot(data = df2,x = "Study",y = "contribution",color="Source",add="jitter")+
facet_grid(Source~SampleType+Delivery)+
stat_compare_means(comparisons = my_comparisons,method = "t.test")
wilcox
ggboxplot(data = df2,x = "Study",y = "contribution",color="Source",add="jitter")+
facet_grid(Source~SampleType+Delivery)+
stat_compare_means(comparisons = my_comparisons,method = "wilcox")
ggboxplot(data = df2,x = "Study",y = "contribution",color="Study",add="jitter")+
facet_grid(Source~SampleType+Delivery)+
stat_compare_means(comparisons = my_comparisons,method = "wilcox")
ggboxplot(data = df2,x = "Study",y = "contribution",color="Study",add="jitter")+
facet_grid(Source~SampleType+Delivery,scales = "free")+
stat_compare_means(comparisons = my_comparisons,method = "wilcox")
ggboxplot(data = df2,x = "Study",y = "contribution",color="Study",add="jitter")+
facet_grid(Source~SampleType+Delivery)+
stat_compare_means(comparisons = my_comparisons,method = "wilcox")
ggboxplot(data = df2,x = "Study",y = "contribution",color="Study",add="jitter",palette = "npg")+
facet_grid(Source~SampleType+Delivery)+
stat_compare_means(comparisons = my_comparisons,method = "wilcox")
ggboxplot(data = df2,x = "Study",y = "contribution",color="Study",add="jitter",palette = "npg")+
facet_grid(SampleType~Source+Delivery)+
stat_compare_means(comparisons = my_comparisons,method = "wilcox")
df2
ggboxplot(data = df2,x = "Study",y = "contribution",color="Study",add="jitter",palette = "npg")+
facet_grid(SampleType+Delivery~Source)+
stat_compare_means(comparisons = my_comparisons,method = "wilcox")
ggboxplot(data = df2,x = "Study",y = "contribution",color="Study",add="jitter",palette = "npg")+
facet_grid(SampleType+Delivery~Source)+
stat_compare_means(comparisons = my_comparisons,method = "wilcox")+ylim(c(0,2))+
df2<-df2%>%group_by(Study,SampleType,Delivery,Source)%>%
summarize(contribution=mean(contribution))%>%ungroup()
ggboxplot(data = df2,x = "Study",y = "contribution",color="Study",add="jitter",palette = "npg")+
facet_grid(SampleType+Delivery~Source)+
stat_compare_means(comparisons = my_comparisons,method = "wilcox")+ylim(c(0,2))
ggboxplot(data = df2,x = "Study",y = "contribution",color="Study",add="jitter",palette = "npg")+
facet_grid(SampleType+Delivery~Source)+
stat_compare_means(comparisons = my_comparisons,method = "wilcox")+ylim(c(0,1.2))
ggboxplot(data = df2,x = "Study",y = "contribution",color="Study",add="jitter",palette = "npg")+
facet_grid(SampleType+Delivery~Source)+
stat_compare_means(comparisons = my_comparisons,method = "wilcox")+ylim(c(0,1.0))
ggboxplot(data = df2,x = "Study",y = "contribution",color="Study",add="jitter",palette = "npg")+
facet_grid(SampleType+Delivery~Source)+
stat_compare_means(comparisons = my_comparisons,method = "wilcox")+ylim(c(0,1))
ggboxplot(data = df2,x = "Study",y = "contribution",color="Study",add="jitter",palette = "npg")+
facet_grid(SampleType+Delivery~Source)+
stat_compare_means(comparisons = my_comparisons,method = "wilcox")+ylim(c(0,1.25))
ggboxplot(data = df2,x = "Study",y = "contribution",color="Study",add="jitter",palette = "npg")+
facet_grid(SampleType+Delivery~Source)+
stat_compare_means(comparisons = my_comparisons,method = "wilcox")+ylim(c(0,1.1))
ggboxplot(data = df2,x = "Study",y = "contribution",color="Study",add="jitter",palette = "npg")+
facet_grid(SampleType+Delivery~Source)+
stat_compare_means(comparisons = my_comparisons,method = "wilcox")+ylim(c(0,1.1))+yscle("log10")
ggboxplot(data = df2,x = "Study",y = "contribution",color="Study",add="jitter",palette = "npg")+
facet_grid(SampleType+Delivery~Source)+
stat_compare_means(comparisons = my_comparisons,method = "wilcox")+ylim(c(0,1.1))+yscale("log10")
ggboxplot(data = df2,x = "Study",y = "contribution",color="Study",add="jitter",palette = "npg")+
facet_grid(SampleType+Delivery~Source)+
stat_compare_means(comparisons = my_comparisons,method = "wilcox")+ylim(c(0,10))+yscale("log10")
ggboxplot(data = df2,x = "Study",y = "contribution",color="Study",add="jitter",palette = "npg")+
facet_grid(SampleType+Delivery~Source)+
stat_compare_means(comparisons = my_comparisons,method = "wilcox")+yscale("log10")+ylim(c(0,10))
ggboxplot(data = df2,x = "Study",y = "contribution",color="Study",add="jitter",palette = "npg")+
facet_grid(SampleType+Delivery~Source)+
stat_compare_means(comparisons = my_comparisons,method = "wilcox")+yscale("log10")+ylim(c(0,1.2))
ggboxplot(data = df2,x = "Study",y = "contribution",color="Study",add="jitter",palette = "npg")+
facet_grid(SampleType+Delivery~Source)+
stat_compare_means(comparisons = my_comparisons,method = "wilcox")+yscale("log10")+ylim(c(0,1.1))
df2
anova(contribution~.,df2)
lm(contribution~.,df2)
l<-lm(contribution~.,df2)
anova(lm)
aov(lm)
library(mosaic)
aov(lm)
l<-aovcontribution~.,df2)
l<-aov(contribution~.,df2)
l
msummary(l)
l<-log(contribution~.,df2)
l<-lm(contribution~.,df2)
l
l
msummary(l)
df2
library(mosaic)
l<-lm(contribution~.,df2)
l
msummary(l)
df2
df2%>%mutate(across(where(is.character,factor)))
df2<-df2%>%mutate(across(where(is.character,factor)))
df2<-df2%>%mutate(across(where(is.character),factor))
library(mosaic)
l<-lm(contribution~.,df2)
l
msummary(l)
aov(lm)
TukeyHSD(l)
l<-lm(contribution~Study*Delivery*Source*SampleType,df2)
l
msummary(l)
aov(l)
msummary(aov(l))
msummary(anova(l))
anova(l)
df2
df2%>%rename(Study=disease)
df2%>%rename(disease=Study)
df2<-df2%>%rename(disease=Study)
library(ggpubr)
my_comparisons <- list(c("Control","T1D"))
ggboxplot(data = df2,x = "disease",y = "contribution",color="Study",add="jitter",palette = "npg")+
facet_grid(SampleType+Delivery~Source)+
stat_compare_means(comparisons = my_comparisons,method = "wilcox")+yscale("log10")+ylim(c(0,1.1))
ggboxplot(data = df2,x = "disease",y = "contribution",color="disease",add="jitter",palette = "npg")+
facet_grid(SampleType+Delivery~Source)+
stat_compare_means(comparisons = my_comparisons,method = "wilcox")+yscale("log10")+ylim(c(0,1.1))
ggboxplot(data = df2,x = "disease",y = "contribution",color="disease",add="jitter",palette = "npg",
title = "sourcetracker2 derived maternal source contibutions to neonatal microbiomes")+
facet_grid(SampleType+Delivery~Source)+
stat_compare_means(comparisons = my_comparisons,method = "wilcox")+yscale("log10")+ylim(c(0,1.1))
df2<-df2%>%group_by(Study,SampleType,Delivery,Source)%>%
summarize(contribution=mean(contribution))%>%ungroup()
df2
df2<-df2%>%pivot_longer(cols =-c(Study,SampleType,Delivery,Antibiotics),names_to = "Source",values_to = "contribution")
df2<-df2%>%rename(disease=Study)
library(ggpubr)
my_comparisons <- list(c("Control","T1D"))
ggboxplot(data = df2,x = "disease",y = "contribution",color="disease",add="jitter",palette = "npg",
title = "sourcetracker2 derived maternal source contibutions to neonatal microbiomes")+
facet_grid(SampleType+Delivery~Source)+
stat_compare_means(comparisons = my_comparisons,method = "wilcox")+yscale("log10")+ylim(c(0,1.1))
df2<-df2%>%group_by(Study,SampleType,Delivery,Source)%>%
summarize(contribution=mean(contribution))%>%ungroup()
df2
df2<-df[,17:21]
df2<-df2%>%mutate(across(where(is.character),factor))
library(mosaic)
l<-lm(contribution~Study*Delivery*Source*SampleType,df2)
l
anova(l)
msummary(l)
df2<-df2%>%rename(disease=Study,sink=SampleType)
df2<-df2%>%rename(disease=Study)%>%rename(sink=SampleType)
library(ggpubr)
my_comparisons <- list(c("Control","T1D"))
ggboxplot(data = df2,x = "disease",y = "contribution",color="disease",add="jitter",palette = "npg",
title = "sourcetracker2 derived maternal source contibutions to neonatal microbiomes")+
facet_grid(sink+Delivery~Source)+
stat_compare_means(comparisons = my_comparisons,method = "wilcox")+yscale("log10")+ylim(c(0,1.1))
df2<-df2%>%rename(disease=Study)%>%rename(Sink=SampleType)
df2<-df%>%
select(Study,SampleType,Delivery,Antibiotics,
Anus,Cervix,Introitus,Vagina,Unknown)#,
df2
df2
df2<-df2%>%pivot_longer(cols =-c(Study,SampleType,Delivery,Antibiotics),names_to = "Source",values_to = "contribution")
df2<-df2%>%rename(disease=Study)%>%rename(Sink=SampleType)
library(ggpubr)
my_comparisons <- list(c("Control","T1D"))
ggboxplot(data = df2,x = "disease",y = "contribution",color="disease",add="jitter",palette = "npg",
title = "sourcetracker2 derived maternal source contibutions to neonatal microbiomes")+
facet_grid(sink+Delivery~Source)+
stat_compare_means(comparisons = my_comparisons,method = "wilcox")+yscale("log10")+ylim(c(0,1.1))
ggboxplot(data = df2,x = "disease",y = "contribution",color="disease",add="jitter",palette = "npg",
title = "sourcetracker2 derived maternal source contibutions to neonatal microbiomes")+
facet_grid(Sink+Delivery~Source)+
stat_compare_means(comparisons = my_comparisons,method = "wilcox")+yscale("log10")+ylim(c(0,1.1))
df2<-df2%>%group_by(Study,Sink,Delivery,Source)%>%
summarize(contribution=mean(contribution))%>%ungroup()
df2
df2<-df%>%
select(Study,SampleType,Delivery,Antibiotics,
Anus,Cervix,Introitus,Vagina,Unknown)#,
df2
df2
df2<-df2%>%pivot_longer(cols =-c(Study,SampleType,Delivery,Antibiotics),names_to = "Source",values_to = "contribution")
df2<-df2%>%rename(disease=Study)%>%rename(Sink=SampleType)
library(ggpubr)
my_comparisons <- list(c("Control","T1D"))
ggboxplot(data = df2,x = "disease",y = "contribution",color="disease",add="jitter",palette = "npg",
title = "sourcetracker2 derived maternal source contibutions to neonatal microbiomes")+
facet_grid(Sink+Delivery~Source)+
stat_compare_means(comparisons = my_comparisons,method = "wilcox")+yscale("log10")+ylim(c(0,1.1))
df3<-df2%>%group_by(Study,Sink,Delivery,Source)%>%
summarize(contribution=mean(contribution))%>%ungroup()
df2
df3
df3<-df2%>%group_by(Study,Sink,Delivery,Source)%>%
summarize(contribution=mean(contribution))%>%ungroup()
df3<-df2%>%group_by(disease,Sink,Delivery,Source)%>%
summarize(contribution=mean(contribution))%>%ungroup()
df2
df3
df3<-df2%>%group_by(disease,Sink,Delivery,Source)%>%
summarize(contribution=mean(contribution))%>%ungroup()%>%pivot_wider(names_from = Source,values_from=contribution)
df2
df3
df3<-df2%>%group_by(disease,Sink,Delivery,Source)%>%
summarize(mean_contribution=mean(contribution),
sd_contribution=sd(contribution))%>%ungroup()%>%pivot_wider(names_from = Source,values_from=contribution)
df2
df3<-df2%>%group_by(disease,Sink,Delivery,Source)%>%
summarize(mean_contribution=mean(contribution),
sd_contribution=sd(contribution))
df2
df3
write.table(df3,"contribution_overview.tsv",sep = "\t")
write.table(df3,"k:/github/Type_1_Diabetes_public/sourcetracker/contribution_overview.tsv",sep = "\t")
l<-lm(contribution~Study*Delivery*Source*SampleType,df2)
l<-lm(contribution~disease*Delivery*Source*Sink,df2)
l
msummary(l)
TukeyHSD(l)
l<-lm(contribution~disease+Delivery+Source+Sink,df2)
msummary(l)
l<-lm(contribution~disease+Delivery+Source*Sink,df2)
msummary(l)
l<-lm(contribution~disease+Delivery*Source*Sink,df2)
msummary(l)
l<-lm(contribution~disease*Delivery*Source*Sink,df2)
msummary(l)
library(broom)
broom::tidy(l)
l2<-broom::tidy(l)
msummary(l)
aov(l)
msummary(aov(l))
msummary(anova(l))
TukeyHSD(l)
msummary(TukeyHSD(l))
l2
write.table(l2,file = "lm.tsv",sep = "\t")
setwd("k:/github/Type_1_Diabetes_public/sourcetracker/")
l2<-broom::tidy(l)
write.table(l2,file = "lm.tsv",sep = "\t")
